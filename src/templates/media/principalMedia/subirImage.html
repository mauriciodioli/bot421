{% extends 'layouts/layout.html'%}
{% block content%}
<!-- Modal -->
<style>
  .modal-title {
    text-align: center;
    margin: 0 auto;
    width: 100%;
    color: black;
  }

  .dz-preview {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 100%;
    max-height: 300px; /* Establece una altura máxima para las imágenes */
    border: 2px dashed #ccc;
    background-color: #f9f9f9;
    margin-bottom: 10px;
    padding: 10px;
    box-sizing: border-box;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .dz-preview img {
    max-width: 100%;
    max-height: 100%;
    width: auto;
    height: auto;
    object-fit: cover;
  }
  
  .description-block {
    text-align: center;
    margin-bottom: 20px;
  }
  .description-block {
    text-align: center;
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    color: black;
  }
  .container {
    padding: 20px;
    color: black;
  }
  #file-description {
    width: 100%;
    height: 100%;
    resize: none;
  }
</style>
<div  id="modUpImage" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title " id="exampleModalLabel" style="color: black;">Cargar Imagen o Video</h5>
        <button type="button" onclick="window.location.href='/home'" class="btn-close" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <!-- Contenido del modal -->
        <div id="popup">
          <div class="container">
          <div class="description-block">          
            <textarea id="file-description" rows="3" ></textarea>
          </div>
        </div>
          <form id="my-dropzone" action="/cargarImagen" class="dropzone">
            <div class="dz-message" style="text-align: center; margin: 20px 0; color: black;">
              Arrastra y suelta aquí tus archivos (imagen o video)
            </div>
          </form>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" id="open-popup">Subir Archivo</button>
      </div>
    </div>
  </div>
</div>


<script>
  $(document).ready(function() {
    // Configuración de Dropzone.js
    Dropzone.options.myDropzone = {
      acceptedFiles: 'image/*,video/*',
      maxFiles: 1,
      success: function(file, response) {
        // Lógica adicional después de cargar el archivo (por ejemplo, mostrar una vista previa)
        console.log(response);
        // Ajustar el tamaño de la imagen después de que se carga
        ajustarTamanioImagen();
      }
    };

    // Función para ajustar el tamaño de la imagen al tamaño del contenedor
    function ajustarTamanioImagen() {
      var contenedor = $('.dz-preview');
      var imagen = contenedor.find('img');
      imagen.css('max-width', '100%');
      imagen.css('max-height', '100%');
    }

    // Llamar a la función cuando se redimensiona la ventana
    $(window).resize(function() {
      ajustarTamanioImagen();
    });
    
    // Enviar el formulario al hacer clic en el botón "Subir Archivo"
    $('#open-popup').click(function() {
      $('#my-dropzone').submit();
    });
  });
</script>

{% endblock %}
